"0","# Crear la función de log-verosimilitud específica para los datos observados con 317 errores"
"0","log_verosim_func <- crear_log_verosim(n = 500, n_err = 317)"
"0",""
"0","# Generar una tabla con valores de p y la verosimilitud correspondiente"
"0","grafica_tbl <- tibble(p = seq(0, 1, 0.001)) %>%"
"0","  mutate(log_verosimilitud = sapply(p, log_verosim_func))"
"0",""
"0","# Encontrar el valor de p que maximiza la verosimilitud"
"0","resultado <- optimize(log_verosim_func, c(0, 1), maximum = TRUE)"
"0","p_max <- resultado$maximum"
"0",""
"0","# Graficar la función de log-verosimilitud con la línea en el valor que maximiza"
"0","ggplot(grafica_tbl, aes(x = p, y = log_verosimilitud)) +"
"0","  geom_line() +"
"0","  geom_vline(xintercept = p_max, color = ""red"", linetype = ""dashed"") +"
"0","  labs("
"0","    title = ""Función de log-verosimilitud en función de p"","
"0","    subtitle = paste(""Máximo estimado en p ="", round(p_max, 4)),"
"0","    x = ""Probabilidad de error (p)"","
"0","    y = ""Log-verosimilitud"""
"0","  ) +"
"0","  theme_minimal()"
